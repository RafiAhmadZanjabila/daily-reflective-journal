{% extends 'app/layout.html' %}
{% load static %}
{% load custom_filters %}

{% block title %}Habit Entry{% endblock %}

{% block css %}
<link rel="stylesheet" href="{% static 'app/styles/diary.css' %}">
{% endblock %}

{% block content %}
<div class="container mt-5 diary-detail">
    <h3><u>{{ entry.habit.name }}</u></h3>
    <div class="entry-layout">
        <div class="entry-text mt-3" id="habit-description">
            <p><b>{{ entry.duration_minutes|minutes_to_hours_minutes }}</b> on <b>{{ entry.start_time|date:"F j, Y" }}</b></p>
            <p>From <b>{{ entry.start_time|date:"h:i A" }}</b> to <b>{{ entry.end_time|date:"h:i A" }}</b></p>
            {% if entry.description %}
                <p>{{ entry.description|linebreaksbr }}</p>
            {% endif %}
        </div>
    </div>
    <div class="mt-3 edit-delete">
        <button class="btn btn-primary" id="edit-button"><i class="fas fa-edit"></i> Edit</button>
        <button class="btn btn-danger" id="delete-button"><i class="fas fa-trash-alt"></i> Delete</button>
    </div>
    <a href="{% url 'habits' %}" class="btn btn-light mt-3">Back to Habits</a>
</div>

<div class="container mt-5 diary-edit-form" id="habit-edit-form" style="display:none;">
    <h3>Edit Habit Entry</h3>
    <form class="diary-form" id="update-form">
        {% csrf_token %}
        <div class="form-group">
            <label for="start_time">Start Time</label>
            <input type="datetime-local" class="form-control" name="start_time" id="start_time" value="{{ entry.start_time|date:"Y-m-d\TH:i" }}" required>
        </div>
        <div class="form-group">
            <label for="end_time">End Time</label>
            <input type="datetime-local" class="form-control" name="end_time" id="end_time" value="{{ entry.end_time|date:"Y-m-d\TH:i" }}" required>
        </div>
        <div class="form-group">
            <label for="description">Description (optional)</label>
            <textarea class="form-control" name="description" id="description" rows="5">{{ entry.description }}</textarea>
        </div>
        <button type="submit" class="btn btn-danger mt-3">Save</button>
        <button type="button" class="btn btn-secondary mt-3" id="cancel-edit">Cancel</button>
    </form>
    <br>
</div>
{% endblock %}

{% block javascript %}
<script defer src="{% static 'app/scripts/habit.js' %}"></script>
{% endblock %}